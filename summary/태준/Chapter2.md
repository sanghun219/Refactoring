<br>

# Chapter2 리팩터링 원칙

<br><br>

---

<br><br>

### 정의

<br>

수많은 다른 소프트웨어 개발 용어와 마찬가지로 리팩터링도 엔지니어들 사이에서 다소 두리뭉실한 의미로 통용된다. 저자는 '리팩터링'이란 용어를 명사로도 쓰고, 동사로도 쓴다.

**리팩터링: 소프트웨어의 겉보기 동작은 그대로 유지한 채, 코드를 이해하고 수정하기 쉽도록 내부 구조를 변경하는 기법**

**리팩터링(하다): [동사] 소프트웨어의 겉보기 동작은 그대로 유지한 채, 여러 가지 리팩터링 기법을 적용해서 소프트웨어를 재구성하다.**

<br>

**누군가 "리팩터링하다가 코드가 깨져서 며칠이나 고생했다"라고 한다면, 십중팔구 리팩터링한 것이 아니다.**

<br>

리펙터링을 정의할 떄 '겉보기 동작(observable behavior)' 이란 표현을 썻다.
- 리펙터링 전과 후의 코드가 똑같이 동작해야 한다는 뜻이다.
- 완전히 똑같다는 말은 아니다.
  - **함수 추출하기**를 거치면 콜스택이 달라져서 성능이 변할 수 있다.
  - **함수 선언 바꾸기**나 **함수 옮기기** 같은 리팩터링을 하면 모듈의 인터페이스가 바뀔 수도 있다.
- 리펙터링 과정에서 발견된 버그는 리팩터링 후에도 그대로 남아 있어야 한다.

<br>

리펙터링하는 이유
- 소프트웨어 설계가 좋아진다.
- 소프트웨어를 이해하기 쉬워진다.
- 버그를 쉽게 찾을 수 있다.
- 프로그래밍 속도를 높일 수 있다.

<br>

언제 리펙터링해야 하는가?

**3의 법칙** (돈 로버츠)
1. 처음에는 그냥 한다.
2. 비슷한 일을 두번째로 하게 되면, 일단 계속 진행 한다.
3. 비슷한 일을 세 번째 하게 되면 리펙터링한다.

<br>

준비를 위한 리팩터링: 기능을 쉽게 추가하게 만들기
- 구조를 살짝 바꾸면 다른 작업을 하기가 훨씬 쉬워질 만한 부분을 찾는다.

<br>

이해를 위한 리팩터링: 코드를 이해하기 쉽게 만들기
- 코드를 파악할 때마다 그 코드의 의도가 더 명확하게 드러나도록 리팩터링할 여지가 없는지 찾는다.

<br>

쓰레기 줍기 리펙터링
- 일을 비효율적으로 처리하는 모습을 발견했을 때

<br>

**보기 싫은 코드를 발견하면 리펙터링하자. 그런데 잘 작성된 코드 역시 수많은 리팩터링을 거쳐야 한다.**

<br>

**무언가 수정하려 할 때는 먼저 수정하기 쉽게 정돈하고 그런 다음 쉽게 수정하자.**

<br>

리팩터링하지 말아야 할 떄
- 외부 API를 다룰 때
- 리팩터링하는 것보다 처음부터 새로 작성하는 게 쉬울 때

<br>

**리팩터링 시 고려할 문제**

<br>

- 새 기능 개발 속도 저하

**리팩터링의 궁극적인 목적은 개발 속도를 높여서, 더 적은 노력으로 더 많은 가치를 창출하는 것이다.**

<br>

- 코드 소유권

<br>

- 브랜치

<br>

- 테스팅

<br>

- 레거시 코드

<br>

- 데이터베이스

<br>

**리팩터링의 유래**

<br>

용어의 정확한 유래는 찾을 수 없다.

워드와 켄트는 소프트웨어 개발 방법을 고민했고, 그 결과로 XP가 탄생
그 과정에 생산력을 높이는 데 리팩터링의 역할이 크다는 사실을 깨달음

